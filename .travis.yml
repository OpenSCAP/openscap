sudo: required

before_install:
  - sudo apt-get -qq update
  - sudo apt-get install -y autoconf autoconf-archive automake libtool lcov libdbus-1-dev libdbus-glib-1-dev libcurl4-openssl-dev libgcrypt-dev libselinux1-dev libgconf2-dev libacl1-dev libblkid-dev libcap-dev libxml2-dev swig libxml-parser-perl libxml-xpath-perl libperl-dev librpm-dev swig librtmp-dev

language: c

before_script:
  - autoreconf -if
  - mkdir build
  - cd build

script:
  - ../configure --enable-code-coverage && build-wrapper-linux-x86-64 --out-dir bw-output make clean all
  - make check-code-coverage VERBOSE=true || true
  - cd .. && sonar-scanner

addons:
  sonarcloud:
    organization: "matejak-github"


cache:
  directories:
    - '$HOME/.sonar/cache'
